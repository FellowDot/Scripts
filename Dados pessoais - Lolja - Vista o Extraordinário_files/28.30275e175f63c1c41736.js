(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[28],{sNxV:function(t,e,n){"use strict";var a=n("Y85n"),r=n("6F4G"),c=n("r0ML"),o=n.n(c),s=n("g0xT"),i=n("0ubZ"),u=n("gfo/"),l=n("y9bU"),b=n("Fmg2"),p=o.a.createElement;function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(a.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}e.a=function(t){var e=Object(r.a)({},t),n=Object(s.d)(u.t),a=Object(c.useState)(!0),o=a[0],d=a[1],f={};f=m(m({},f),{},o?{iconPath:Object(i.a)("img/eye.svg"),label:Object(l.b)("success.password.show_password",n)}:{iconPath:Object(i.a)("img/close-eye.svg"),label:Object(l.b)("success.password.hide_password",n)});var O=p("div",{role:"button",className:"icon-inside-input align-right-password action-password",tabIndex:0,onClick:function(){d(!o)}},p("img",{src:f.iconPath,alt:f.label,title:f.label}));return p(b.a,Object(r.a)({type:o?"password":"text",iconInsideInput:O},e))}},v8L7:function(t,e,n){"use strict";n.r(e);var a=n("wFAD"),r=n.n(a),c=n("1tHM"),o=n("r0ML"),s=n.n(o),i=n("ztjk"),u=n.n(i),l=n("g0xT"),b=n("y9bU"),p=n("hycj"),d=n("6WzT"),m=n("Y85n"),f=n("5Thv"),O=n("gfo/"),j=n("qARM"),g=n("ntgy"),h=n("QvVi"),w=n("stZC");function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(m.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y=function(t,e){return function(){var n=Object(c.a)(r.a.mark((function n(a,c){var o,s,i,u,l;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=c(),s=Object(O.r)(o),i=Object(g.i)(o),u=Object(g.p)(o),n.next=6,f.Capsule.request("node.auth_login",{email:t,baseUrl:u,password:e,cartId:s,storeId:i});case 6:if(!(l=n.sent).authSuccess){n.next=11;break}return a(Object(j.h)(l.data)),a(Object(w.f)(!0)),n.abrupt("return",l);case 11:return n.abrupt("return",l);case 12:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}()},_=function(t,e,n){return function(){var e=Object(c.a)(r.a.mark((function e(a,c){var o,s,i,l,b,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=c(),s=Object(g.i)(o),i=Object(O.r)(o),l=Object(g.p)(o),e.next=6,f.Capsule.request("node.confirmation_code",{email:t,token:n,storeId:s});case 6:if(!0!==(b=e.sent).codeSuccess){e.next=19;break}return e.next=10,f.Capsule.request("node.auth_login",{email:t,baseUrl:l,token:n,cartId:i,storeId:s});case 10:if(!0!==(p=e.sent).authSuccess){e.next=18;break}return a(Object(j.h)(p.data)),e.next=15,a(Object(j.a)(i,!0));case 15:return a(Object(w.f)(!0)),u.a.info("[SmartSignIn] Customer without password clicked to sign in"),e.abrupt("return",!0);case 18:return e.abrupt("return",p);case 19:return e.abrupt("return",b);case 20:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},x=function(t){return function(){var e=Object(c.a)(r.a.mark((function e(n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(Object(j.i)(t));case 2:return e.next=4,n(Object(h.c)({contact_accepts_marketing:t.accepts_marketing}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},S=n("j1IH"),E=n("rkV4"),N=n("CMUK"),P=n("sNxV"),C=n("1GEk"),I=s.a.createElement,F=function(){var t=Object(l.c)(),e=Object(l.d)(d.l);return I("div",{className:"container-buy-without-pass"},I(N.a,{"data-testid":"btnBuyWithoutPassowrd",className:"text-uppercase",btnStyle:"secondary",onClick:function(){return t(Object(w.f)(!0)),void u.a.info("[SmartSignIn] Customer ".concat(e?"with":"without"," password clicked continue as guest"))}},I(b.a,{label:"customer.buy_without_password"})))},D=n("Fmg2"),U=s.a.createElement,T=function(t){var e=t.formik,n=Object(o.useState)(!1),a=n[0],s=n[1],i=Object(o.useState)(!1),m=i[0],f=i[1],O=Object(o.useState)("15"),j=O[0],g=O[1],v=Object(l.d)(d.l),k=Object(l.d)(S.h),y=(Object(l.d)(S.i),Object(l.d)(S.g)),x=Object(l.c)(),P=function(t){var e=t,n=setInterval((function(){e<=0&&clearInterval(n),g(!!e&&"".concat(e,"s")),e-=1}),1e3)},I=function(){var t=Object(c.a)(r.a.mark((function t(){var e;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x(Object(w.e)());case 2:e=t.sent,s(e),e||P(30),u.a.info("[SmartSignIn] Customer without password clicked to resend OTP");case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),T=function(){var t=Object(c.a)(r.a.mark((function t(){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s(!1),f(!0),y){t.next=7;break}e.setFieldError("contact.code_confirmation",Object(E.notEmpty)()),e.setFieldTouched("contact.code_confirmation",!0,!1),t.next=11;break;case 7:return t.next=9,x(_(k,0,y));case 9:(n=t.sent)&&n.labelError&&(u.a.info("[SmartSignIn] Customer without password failed attempt to sign in - ".concat(n.labelError)),s(n));case 11:f(!1);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(o.useEffect)((function(){v||(u.a.info("[SmartSignIn] Send email to customer without password to receive OTP"),I())}),[]),U("div",{className:"panel container-password-smart-sign-in"},U("div",{className:"panel box-customer-password-smart-sign-in"},U("h3",{className:"text-semi-bold m-bottom-quarter m-top-none"},U(b.a,{label:"customer.send_code_to_you"})),U("p",{className:"opacity-80 text-small m-top-none m-bottom"},U(b.a,{label:"customer.enter_the_code"})),U("div",null,U(N.a,{disabled:j,className:"m-bottom",type:"link",btnStyle:"link",onClick:function(){g(!0),I()}},U(b.a,{label:"customer.resend_code"}))),U("div",{className:"row"},U("div",{className:"col-12"},U(p.FastField,{name:"contact.code_confirmation",id:"contact.code_confirmation",type:"text",className:"input-lg",component:D.a,validate:E.notEmpty,onChange:function(t){return x(Object(h.c)({contact_code_confirmation:t.target.value}))},label:U(b.a,{label:"customer.code_confirmation"})}))),U(C.a,{show:Boolean(a),type:"danger",className:"m-top full-width",label:a&&a.labelError}),U(N.a,{"data-testid":"btnStartSessionLogIn",className:"text-uppercase m-top-half",onClick:function(){return T()},loading:m},U(b.a,{label:"customer.start_session"}))),U("div",{className:"m-top"},U(F,null)))},L=n("gPsw"),M=n("Z0nF"),V=s.a.createElement,q=Object(M.withRouter)((function(t){var e=t.storeUrl,n=t.router,a=Object(l.d)((function(t){return Object(g.s)(t,{tag:"quito-smart-sign-in"})})),r=Object(l.d)((function(t){return Object(O.b)(t,{tag:"ab-cart-smart-sign-in"})})),c=Object(l.d)(O.gb),o=Object(l.d)(g.f);if(!(!a||a&&"a"===r)||c)return!1;var s=n.asPath,i="".concat(e,"/account/login/?prop_rel=noopener%20noreferrer&redirect_to=").concat(e).concat(s);return V("div",{className:"login-info m-bottom"},V(b.a,{data:{loginUrl:i},label:"login_link",onClick:function(t){"A"===t.target.nodeName&&u.a.info("[login][".concat(o,"] User redirected to login page"))}}))})),z=s.a.createElement,A=function(t){var e=t.formik,n=Object(o.useState)(!1),a=n[0],s=n[1],i=Object(l.d)((function(t){return Object(g.s)(t,{tag:"online-lgpd-abandoned-carts"})})),u=Object(l.d)(S.h),m=Object(l.d)(S.h),f=Object(l.d)(d.k),j=Object(l.d)(d.p),v=Object(l.d)(d.l),y=Object(l.d)(g.p),_=Object(l.d)(O.E),P=Object(l.d)(S.l),C=Object(l.c)();Object(o.useEffect)((function(){i&&(_.accepts_marketing?C(Object(h.c)({contact_accepts_marketing:_.accepts_marketing})):(_.accepts_marketing=!1,C(x(_))))}),[]);var I=function(){var t=Object(c.a)(r.a.mark((function t(){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s(!0),t.next=3,Object(E.emailValidate)(u);case 3:if(n=t.sent){t.next=9;break}return t.next=7,C(Object(w.g)(u));case 7:t.next=11;break;case 9:e.setFieldError("contact.email",n),e.setFieldTouched("contact.email",!0,!1);case 11:s(!1);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return z("div",{className:"panel-with-header"},z("h3",{className:"panel-header panel-header-sticky"},z(b.a,{label:"contact_info"})),i&&z(q,{storeUrl:y}),j&&!0===v&&z("div",{className:"m-bottom-half"},z(b.a,{label:"customer.you_have_password"})),z(p.Field,{name:"contact.email",id:"contact.email",type:"email",validate:E.emailValidate,component:D.a,label:z(b.a,{label:"step1_email"}),onChange:function(t){return C(Object(h.c)({contact_email:t.target.value}))},"data-testid":"email",autoComplete:"shipping email",autoCapitalize:"on",button:null!==f&&j&&z(N.a,{"data-testid":"btnChangeEmail",className:"form-control-help",btnStyle:"link",onClick:function(){return C(Object(w.d)({email:null,hasPassword:null,customerId:null,codeSentToEmail:null})),void C(Object(w.f)(!1))}},z(b.a,{label:"general.change"})),disabled:null!==f&&j,onKeyPress:function(t){"Enter"===t.key&&(t.preventDefault(),I())}}),!j&&i&&z("div",{className:"m-bottom"},z(L.a,{htmlFor:"checkbox",id:"acceptedMarketing",name:"acceptedMarketing",checked:P.contact_accepts_marketing,onChange:function(){return C(function(t){return function(){var e=Object(c.a)(r.a.mark((function e(n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.accepts_marketing=!t.accepts_marketing,window.LS.cart=k(k({},window.LS.cart),{},{contact:k(k({},window.LS.cart.contact),{},{accepts_marketing:t.accepts_marketing})}),e.next=4,n(x(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(_))}},z(b.a,{label:"customer.accepts_marketing"}))),!i&&z(q,{storeUrl:y}),j&&(null===m||null===f)&&z(N.a,{"data-testid":"btnVerifyEmail",className:"pull-right text-uppercase m-top-half",onClick:function(){return I()},loading:a},z(b.a,{label:"general.continue"})))},B=s.a.createElement;e.default=function(t){var e=t.formik,n=Object(o.useState)(!1),a=n[0],i=n[1],m=Object(o.useState)(!1),f=m[0],O=m[1],j=Object(l.c)(),g=Object(l.d)(d.l),w=Object(l.d)(S.h),v=Object(l.d)(S.i),k=Object(l.d)(d.p),_=function(){var t=Object(c.a)(r.a.mark((function t(){var e;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i(!0),Object(E.notEmpty)(v)){t.next=7;break}return u.a.info("[SmartSignIn] Customer with password clicked to sign in"),t.next=5,j(y(w,v));case 5:(e=t.sent).labelError&&(u.a.info("[SmartSignIn] Customer with password error attempt to sign in [".concat(e.labelError,"]")),O(e));case 7:i(!1);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return B(s.a.Fragment,null,B(A,{formik:e}),k&&!1===g&&B(T,{formik:e}),k&&!0===g&&B(s.a.Fragment,null,B(p.FastField,{name:"contact.password",id:"contact.password",className:"input-lg",component:P.a,validate:E.notEmpty,onChange:function(t){return j(Object(h.c)({contact_password:t.target.value}))},label:B(b.a,{label:"success.password.password"}),onKeyPress:function(t){"Enter"===t.key&&(t.preventDefault(),_())}}),B(C.a,{show:Boolean(f),type:"danger",className:"m-top full-width",label:f.labelError}),B(N.a,{"data-testid":"btnLogIn",className:"pull-right text-uppercase m-top-half",onClick:function(){return _()},loading:a},B(b.a,{label:"customer.start_session"})),B(F,null)))}}}]);
//# sourceMappingURL=28.30275e175f63c1c41736.js.map